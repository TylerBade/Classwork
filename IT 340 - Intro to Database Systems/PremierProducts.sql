DROP TABLE "REP" cascade constraints;
DROP TABLE "CUSTOMER" cascade constraints;
DROP TABLE "ORDERS" cascade constraints;
DROP TABLE "PART" cascade constraints;
DROP TABLE "ORDER_LINE" cascade constraints;
CREATE TABLE REP
(REP_NUM CHAR(2) PRIMARY KEY,
LAST_NAME CHAR(15),
FIRST_NAME CHAR(15),
STREET CHAR(15),
CITY CHAR(15),
STATE CHAR(2),
ZIP CHAR(5),
COMMISSION DECIMAL(7,2),
RATE DECIMAL(3,2) );
CREATE TABLE CUSTOMER
(CUSTOMER_NUM CHAR(3) PRIMARY KEY,
CUSTOMER_NAME CHAR(35) NOT NULL,
STREET CHAR(15),
CITY CHAR(15),
STATE CHAR(2),
ZIP CHAR(5),
BALANCE DECIMAL(8,2),
CREDIT_LIMIT DECIMAL(8,2),
REP_NUM CHAR(2) );
CREATE TABLE ORDERS
(ORDER_NUM CHAR(5) PRIMARY KEY,
ORDER_DATE DATE,
CUSTOMER_NUM CHAR(3) );
CREATE TABLE PART
(PART_NUM CHAR(4) PRIMARY KEY,
DESCRIPTION CHAR(15),
ON_HAND DECIMAL(4,0),
CLASS CHAR(2),
WAREHOUSE CHAR(1),
PRICE DECIMAL(6,2),
MINIMUM DECIMAL(4,0),
REORDER CHAR(1) );
CREATE TABLE ORDER_LINE
(ORDER_NUM CHAR(5),
PART_NUM CHAR(4),
NUM_ORDERED DECIMAL(3,0),
QUOTED_PRICE DECIMAL(6,2),
PRIMARY KEY (ORDER_NUM, PART_NUM) );
INSERT INTO CUSTOMER
VALUES
('148','Al''s Appliance and Sport','2837 
Greenway','Fillmore','FL','33336',6550.00,7500.00,'20');
INSERT INTO CUSTOMER
VALUES
('282','Brookings Direct','3827 
Devon','Grove','FL','33321',431.50,10000.00,'35');
INSERT INTO CUSTOMER
VALUES
('356','Ferguson''s','382 
Wildwood','Northfield','FL','33146',5785.00,7500.00,'65');
INSERT INTO CUSTOMER
VALUES
('408','The Everything Shop','1828 
Raven','Crystal','FL','33503',5285.25,5000.00,'35');
INSERT INTO CUSTOMER
VALUES
('462','Bargains Galore','3829 
Central','Grove','FL','33321',3412.00,10000.00,'65');
INSERT INTO CUSTOMER
VALUES
('524','Kline''s','838 
Ridgeland','Fillmore','FL','33336',12762.00,15000.00,'20');
INSERT INTO CUSTOMER
VALUES
('608','Johnson''s Department Store','372 
Oxford','Sheldon','FL','33553',2106.00,10000.00,'65');
INSERT INTO CUSTOMER
VALUES
('687','Lee''s Sport and Appliance','282 
Evergreen','Altonville','FL','32543',2851.00,5000.00,'35');
INSERT INTO CUSTOMER
VALUES
('725','Deerfield''s Four Seasons','282 
Columbia','Sheldon','FL','33553',248.00,7500.00,'35');
INSERT INTO CUSTOMER
VALUES
('842','All Season','28 Lakeview','Grove','FL','33321',8221.00,7500.00,'20');
INSERT INTO ORDERS
VALUES
('21608','20-OCT-2003','148');
INSERT INTO ORDERS
VALUES
('21610','20-OCT-2003','356');
INSERT INTO ORDERS
VALUES
('21613','21-OCT-2003','408');
INSERT INTO ORDERS
VALUES
('21614','21-OCT-2003','282');
INSERT INTO ORDERS
VALUES
('21617','23-OCT-2003','608');
INSERT INTO ORDERS
VALUES
('21619','23-OCT-2003','148');
INSERT INTO ORDERS
VALUES
('21623','23-OCT-2003','608');
INSERT INTO PART
VALUES
('AT94','Iron',50,'HW','3',24.95,20,'N');
INSERT INTO PART
VALUES
('BV06','Home Gym',45,'SG','2',794.95,30,'N');
INSERT INTO PART
VALUES
('CD52','Microwave Oven',32,'AP','1',165.00,11,'N');
INSERT INTO PART
VALUES
('DL71','Cordless Drill',21,'HW','3',129.95,20,'N');
INSERT INTO PART
VALUES
('DR93','Gas Range',8,'AP','2',495.00,4,'N');
INSERT INTO PART
VALUES
('DW11','Washer',12,'AP','3',399.99,8,'N');
INSERT INTO PART
VALUES
('FD21','Stand Mixer',22,'HW','3',159.95,22,'Y');
INSERT INTO PART
VALUES
('KL62','Dryer',12,'AP','1',349.95,7,'N');
INSERT INTO PART
VALUES
('KT03','Dishwasher',8,'AP','3',595.00,3,'N');
INSERT INTO PART
VALUES
('KV29','Treadmill',9,'SG','2',1390.00,5,'Y');
INSERT INTO REP
VALUES
('20','Kaiser','Valerie','624 Randall','Grove','FL','33321',20542.50,0.05);
INSERT INTO REP
VALUES
('35','Hull','Richard','532 Jackson','Sheldon','FL','33553',39216.00,0.07);
INSERT INTO REP
VALUES
('65','Perez','Juan','1626 Taylor','Fillmore','FL','33336',23487.00,0.05);
INSERT INTO ORDER_LINE
VALUES
('21608','AT94',11,21.95);
INSERT INTO ORDER_LINE
VALUES
('21610','DR93',1,495.00);
INSERT INTO ORDER_LINE
VALUES
('21610','DW11',1,399.99);
INSERT INTO ORDER_LINE
VALUES
('21613','KL62',4,329.95);
INSERT INTO ORDER_LINE
VALUES
('21614','KT03',2,595.00);
INSERT INTO ORDER_LINE
VALUES
('21617','BV06',2,794.95);
INSERT INTO ORDER_LINE
VALUES
('21617','CD52',4,150.00);
INSERT INTO ORDER_LINE
VALUES
('21619','DR93',1,495.00);
INSERT INTO ORDER_LINE
VALUES
('21623','KV29',2,1290.00);

SELECT *
FROM REP;

SELECT PART_NUM, DESCRIPTION
FROM PART;

SELECT PART_NUM, DESCRIPTION
FROM PART
WHERE DESCRIPTION <> 'Gas Range';

SELECT PART_NUM, DESCRIPTION
FROM PART
WHERE DESCRIPTION LIKE 'D%';

SELECT DESCRIPTION, PRICE
FROM PART
WHERE PRICE = (SELECT MIN(PRICE) 
               FROM PART);

SELECT ORDER_NUM, ORDER_DATE, PART_NUM, NUM_ORDERED
FROM ORDERS NATURAL JOIN ORDER_LINE;

SELECT CUSTOMER_NAME
FROM CUSTOMER
WHERE CREDIT_LIMIT >= 10000;

SELECT ORDER_NUM
FROM ORDERS
WHERE CUSTOMER_NUM = 148 AND ORDER_DATE = '23-OCT-2003';

SELECT CUSTOMER_NUM, CUSTOMER_NAME
FROM CUSTOMER
WHERE REP_NUM = 20 OR REP_NUM = 65;

SELECT PART_NUM, DESCRIPTION
FROM PART
WHERE CLASS <> 'HW';

SELECT PART_NUM, DESCRIPTION, ON_HAND
FROM PART
WHERE ON_HAND > 10 AND ON_HAND < 25;

SELECT PART_NUM, DESCRIPTION, ON_HAND
FROM PART
WHERE ON_HAND BETWEEN 10 AND 25;

SELECT PART_NUM, DESCRIPTION, (ON_HAND * PRICE) AS ON_HAND_VALUE
FROM PART
WHERE CLASS = 'AP';

SELECT PART_NUM, DESCRIPTION, (ON_HAND * PRICE) AS ON_HAND_VALUE
FROM PART
WHERE (ON_HAND * PRICE) >= 7500;

SELECT PART_NUM, DESCRIPTION
FROM PART
WHERE CLASS IN ('HW', 'SG');

SELECT CUSTOMER_NUM, CUSTOMER_NAME
FROM CUSTOMER
WHERE CUSTOMER_NAME LIKE 'D%';

SELECT DESCRIPTION
FROM PART
ORDER BY DESCRIPTION;

SELECT DESCRIPTION
FROM PART
ORDER BY CLASS, PART_NUM;

SELECT DISTINCT CUSTOMER.CUSTOMER_NAME, CUS.CUSTOMER_NAME, CUS.CREDIT_LIMIT
FROM CUSTOMER, CUSTOMER CUS
WHERE CUSTOMER.CREDIT_LIMIT = 10000 AND CUS.CREDIT_LIMIT = 10000 AND CUSTOMER.CUSTOMER_NUM > CUS.CUSTOMER_NUM;

SELECT PART.PART_NUM, PART.DESCRIPTION, P.PART_NUM, P.DESCRIPTION, P.CLASS
FROM PART, PART P
WHERE PART.CLASS = P.CLASS AND PART.PART_NUM > P.PART_NUM
ORDER BY CLASS;

--SELECT *
--FROM REP_COMMISSION;

--SELECT *
--FROM PART_TOTALS;

SELECT CUSTOMER_NAME, BALANCE, CREDIT_LIMIT 
FROM CUSTOMER
WHERE CUSTOMER_NAME = 'All Season';

UPDATE CUSTOMER
SET BALANCE = 0
WHERE CUSTOMER_NAME = 'All Season';

SELECT * 
FROM PART
WHERE PART_NUM = 'AT94';

UPDATE PART
SET ON_HAND = 19
WHERE PART_NUM = 'AT94';

SELECT * 
FROM PART
WHERE PART_NUM = 'AT94';

SELECT * 
FROM PART
WHERE PART_NUM = 'CD52';

UPDATE PART
SET MINIMUM = 49
WHERE PART_NUM = 'CD52'; 

SELECT *
FROM PART 
WHERE PART_NUM = 'CD52';

SELECT * 
FROM PART 
WHERE PART_NUM = 'FD21';

UPDATE PART
SET MINIMUM = 2
WHERE PART_NUM = 'FD21';

SELECT * 
FROM PART 
WHERE PART_NUM = 'FD21';

SELECT * 
FROM PART 
WHERE PART_NUM = 'KV29'; 

UPDATE PART
SET MINIMUM = 9
WHERE PART_NUM = 'KV29';

SELECT * 
FROM PART
WHERE PART_NUM = 'KV29'; 

SELECT *
FROM PART;

EXEC PRC_ORDER_ADD('19-APR-2016', 148);

SELECT *
FROM ORDERS;